<%= stylesheet_link_tag 'travels', media: 'all', 'data-turbolinks-track': 'reload' %>
<%= stylesheet_link_tag 'images', media: 'all', 'data-turbolinks-track': 'reload' %>

<div class='col-sm-10 offset-sm-2 contents'>
  <% if action_name == 'edit' %>
    <h2>Edit card</h2>
  <% else %>
    <h2>New card</h2>
  <% end %>

  <hr>

  <% if @card.errors.any? %>
    <div class='border rounded mt-2 mb-2' id='card_error_area'>
      <% @card.errors.full_messages.each do |m| %>
        <li><%= m %></li>
      <% end %>
    </div>
  <% end %>

  <%= form_with(model: card, local: true) do |f| %>
    <%= f.select :frame_style, @card.frame_style_labels,
          { include_blank: @card.frame_style_label },
          class: 'custom-select mb-3'
    %>

    <%= f.select :font_style, @card.font_style_labels,
          { include_blank: @card.font_style_label },
          class: 'custom-select mb-3'
    %>

    <div id='add_image'>
      <%= f.fields_for :images do |i| %>
        <%= render 'image_fields', f: i %>
      <% end %>
    </div>

    <div class='form-group'>
      <%= f.text_field :title,
                       placeholder: 'title',
                       class: 'form-control'
      %>
    </div>

    <div class='form-group'>
      <%= f.text_area :sentence,
                      placeholder: 'sentence',
                      class: 'form-control'
      %>
    </div>

    <% if action_name == 'edit' %>
      <div class='form-group'>
        <%= f.submit "UPDATE", class: 'btn btn-primary btn-sm' %>
        <%= link_to_add_association 'ADD IMAGE', f, :images,
              class: 'btn btn-primary btn-sm',
              id: 'add_image_link',
              data: { association_insertion_node: '#add_image',
                      association_insertion_method: 'append'
                    }
        %>
        <%= link_to "DELETE", card_path(@card), data: { confirm: "Are you sure?" }, method: :delete, class: 'btn btn-secondary btn-sm' %>
      </div>
    <% else %>
      <div class='form-group'>
        <%= f.submit "CREATE", class: 'btn btn-primary btn-sm' %>
        <%= link_to_add_association 'ADD IMAGE', f, :images,
              class: 'btn btn-primary btn-sm',
              id: 'add_image_link',
              data: { association_insertion_node: '#add_image',
                      association_insertion_method: 'append'
                    }
        %>
      </div>
    <% end %>
  <% end %>
</div>
